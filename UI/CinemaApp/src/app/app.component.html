<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
  <!-- Navbar -->
  <header>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container">
        <a class="navbar-brand" href="">Кинотеатр</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="">Link</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="" id="navbarDropdown" role="button" (click)="getCinemas()" data-bs-toggle="dropdown" aria-expanded="false">
                Кинотеатры
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown" >
                <div *ngFor="let cinema of cinemas">
                  <li><a class="dropdown-item" href="">{{cinema.name}}</a></li>

                </div>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="">Something else here</a></li>
              </ul>
            </li>

            <!-- Add Cinema Button -->
            <li class="nav-item">
              <a class="nav-link" href="add_cinema" data-bs-toggle="modal" data-bs-target="#addCinemaModal">Add Cinema</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="add_hall" data-bs-toggle="modal" (click)="getCinemas()" data-bs-target="#addHallModal">Add Hall</a>
            </li>

            <!-- Add Film Button -->
            <li class="nav-item">
              <a class="nav-link" href="add_film" data-bs-toggle="modal" data-bs-target="#addFilmModal">Add Film</a>
            </li>

            <!-- Add Session Button -->
            <li class="nav-item">
              <a class="nav-link" href="add_session" data-bs-toggle="modal" (click)="getCinemas()" data-bs-target="#addSessionModal">Add Session</a>
            </li>
          </ul>
          <form class="d-flex">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Search</button>
            <button class="btn btn-outline-success" type="submit" data-bs-toggle="modal" data-bs-target="#registrationModal">Reg</button>
            <button class="btn btn-outline-success" type="submit" data-bs-toggle="modal" data-bs-target="#loginModal">Login</button>
          </form>
        </div>
      </div>
    </nav>
  </header>



  <!-- Registration Modal -->
  <section>
    <div class="modal fade" id="registrationModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="registrationModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="registrationModalLabel">Registration</h5>
          </div>
          <div class="modal-body">
            <form #registrationForm="ngForm" (ngSubmit)="onAddUser(registrationForm)">
              <div class="mb-3">
                <label for="login" class="form-label">Login</label>
                <input type="text" ngModel name="login" class="form-control" id="login" required>
              </div>
              <div class="mb-3">
                <label for="password" class="form-label">Password</label>
                <input type="text" ngModel name="cinemaAddress" class="form-control" id="password" required>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button [disabled]="registrationForm.invalid" type="submit" id="registration" class="btn btn-primary">Registration</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Login Modal -->
  <section>
    <div class="modal fade" id="loginModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="loginModalLabel">Login</h5>
          </div>
          <div class="modal-body">
            <form #loginForm="ngForm">
              <div class="mb-3">
                <label for="login" class="form-label">Login</label>
                <input type="text" ngModel name="login" class="form-control" id="login1" required>
              </div>
              <div class="mb-3">
                <label for="password" class="form-label">Password</label>
                <input type="text" ngModel name="cinemaAddress" class="form-control" id="password1" required>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button [disabled]="loginForm.invalid" type="submit" id="log-in" class="btn btn-primary">Login</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Add Cinema Modal -->
  <section>
    <div class="modal fade" id="addCinemaModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="addCinemaModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addCinemaModalLabel">Add Cinema</h5>
          </div>
          <div class="modal-body">
            <form #addCinemaForm="ngForm" (ngSubmit)="onAddCinema(addCinemaForm)">
              <div class="mb-3">
                <label for="cinemaName" class="form-label">Cinema name</label>
                <input type="text" ngModel name="cinemaName" class="form-control" id="cinemaName" required>
              </div>
              <div class="mb-3">
                <label for="cinemaAddress" class="form-label">Cinema address</label>
                <input type="text" ngModel name="cinemaAddress" class="form-control" id="cinemaAddress" required>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button [disabled]="addCinemaForm.invalid" type="submit" id="add-cinema" class="btn btn-primary">Add Cinema</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- Add Hall Modal -->
  <section>
    <div class="modal fade" id="addHallModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="addHallModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addHallModalLabel">Add Hall</h5>
          </div>
          <div class="modal-body">
            <form #addHallForm="ngForm" (ngSubmit)="onAddHall(addHallForm)">
              <div class="mb-3">
                <label for="cinemaDropdown" class="form-label">Cinema Name</label>
                <select ngModel name="cinemaName" class="form-select" id="cinemaDropdown" aria-label="Default select example">
                  <option selected>Choose Cinema</option>
                  <option *ngFor="let cinema of cinemas">{{cinema.name}}</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="hallNumber" class="form-label">Hall number</label>
                <input type="text" ngModel name="hallNumber" class="form-control" id="hallNumber" required>
              </div>
              <div class="mb-3">
                <label for="hallRows" class="form-label">Rows</label>
                <input type="text" ngModel name="hallRows" class="form-control" id="hallRows" required>
              </div>
              <div class="mb-3">
                <label for="hallCols" class="form-label">Columns</label>
                <input type="text" ngModel name="hallCols" class="form-control" id="hallCols" required>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button [disabled]="addHallForm.invalid || addHallForm.value.cinemaName == 'Choose Cinema' || addHallForm.value.cinemaName == ''" type="submit" id="add-hall" class="btn btn-primary" data-bs-dismiss="modal">Add Hall</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Add Session Modal -->
  <section>
    <div class="modal fade" id="addSessionModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="addSessionModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addSessionModalLabel">Add Hall</h5>
          </div>
          <div class="modal-body">
            <form #addSessionForm="ngForm" (ngSubmit)="onAddSession(addSessionForm)">
              <div class="mb-3">
                <label for="cinemaDropdown1" class="form-label">Cinema Name</label>
                <select ngModel name="cinemaName" class="form-select" id="cinemaDropdown1" (click)="getHallsByCinemaName(addSessionForm.value.cinemaName)" aria-label="Default select example">
                  <option selected>Choose Cinema</option>
                  <option *ngFor="let cinema of cinemas" >{{cinema.name}}</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="hallDropdown" class="form-label">Hall Name</label>
                <select ngModel name="hallName" class="form-select" id="hallDropdown"  aria-label="Default select example">
                  <option selected>Choose Hall</option>
                  <option *ngFor="let hall of halls">{{hall.name}}</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="filmDropdown" class="form-label">Film Name</label>
                <select ngModel name="filmName" class="form-select" id="filmDropdown" aria-label="Default select example">
                  <option selected>Choose Film</option>
                  <option *ngFor="let film of films">{{film.name}}</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="time" class="form-label">Time</label>
                <input type="text" ngModel name="time" class="form-control" id="time" required>
              </div>
              <div class="mb-3">
                <label for="price" class="form-label">Rows</label>
                <input type="text" ngModel name="price" class="form-control" id="price" required>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button [disabled]="addSessionForm.invalid ||
                addSessionForm.value.cinemaName == 'Choose Cinema' ||
                addSessionForm.value.cinemaName == '' ||
                addSessionForm.value.hallName == 'Choose Hall' ||
                addSessionForm.value.hallName == '' ||
                addSessionForm.value.filmName == 'Choose Film' ||
                addSessionForm.value.filmName == ''" type="submit" id="add-session" class="btn btn-primary" data-bs-dismiss="modal">Add Session</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- Add Film Modal -->
  <section>
    <div class="modal fade" id="addFilmModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="addFilmModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addFilmModalLabel">Добавить кинотеатр</h5>
          </div>
          <div class="modal-body">
            <form #addFilmForm="ngForm" (ngSubmit)="onAddFilm(addFilmForm)">
              <div class="mb-3">
                <label for="filmName" class="form-label">Name</label>
                <input type="text" ngModel name="filmName" class="form-control" id="filmName" required>
              </div>
              <div class="mb-3">
                <label for="filmDirector" class="form-label">Director</label>
                <input type="text" ngModel name="filmDirector" class="form-control" id="filmDirector" required>
              </div>
              <div class="mb-3">
                <label for="filmGenre" class="form-label">Genre</label>
                <input type="text" ngModel name="filmGenre" class="form-control" id="filmGenre" required>
              </div>
              <div class="mb-3">
                <label for="filmCountry" class="form-label">Country</label>
                <input type="text" ngModel name="filmCountry" class="form-control" id="filmCountry" required>
              </div>
              <div class="mb-3">
                <label for="filmLength" class="form-label">Length</label>
                <input type="text" ngModel name="filmLength" class="form-control" id="filmLength" required>
              </div>
              <div class="mb-3">
                <label for="filmDescription" class="form-label">Description</label>
                <textarea type="text" ngModel name="filmDescription" class="form-control" id="filmDescription" required></textarea>
              </div>
              <div class="mb-3">
                <label for="filmPosterURL" class="form-label">Poster URL</label>
                <input type="text" ngModel name="filmPosterURL" class="form-control" id="filmPosterURL" required>
              </div>
              <div class="mb-3">
                <label for="filmTrailerURL" class="form-label">Trailer URL</label>
                <input type="text" ngModel name="filmTrailerURL" class="form-control" id="filmTrailerURL" required>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button [disabled]="addFilmForm.invalid" type="submit" id="add-film" class="btn btn-primary">Add Cinema</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- Films List -->
  <section>
    <div class="container">
      <div class="card-group">
        <div *ngFor="let film of films">
          <div class="card" style="width: 18rem;">
            <div class="poster">
              <img src="{{findById(film.attributes, 15)}}" class="card-img-top" alt="...">
            </div>

            <div class="card-body">
              <h5 class="card-title">{{film.name}}</h5>
              <a href="" (click)="saveCurFilm(film.objectId); getSessionsByFilmId(film.objectId); getCinemas()" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#filmModal">Show</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- Film Info Modal -->
  <section>
    <div class="modal fade" id="filmModal" tabindex="-1" aria-labelledby="filmModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="filmModalLabel">{{getCurFilmName()}}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" (click)="clear()" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="ratio ratio-16x9">
              <iframe [src]="getById(16) | youtube" allowfullscreen></iframe>
            </div>
            <hr>
            <h6>Genre:</h6>
            <p>{{getById(11)}}</p>
            <h6>Director:</h6>
            <p>{{getById(10)}}</p>
            <h6>County:</h6>
            <p>{{getById(12)}}</p>
            <h6>Description:</h6>
            <p>{{getById(14)}}</p>
            <hr>
            <h5>Sessions</h5>
            <div *ngFor="let cinema of cinemas">
              <h6>{{cinema.name}}</h6>
              <div class="container">
                <div class="row row-cols-2 row-cols-lg-5 g-2 g-lg-3">
                  <div class="col" *ngFor="let session of getSessionsByCinemaId(cinema.objectId)">
                    <div class="p-3 border bg-light">
                      <button type="button" class="btn btn-light" (click) = "saveCurSessionInfo(session.objectId, cinema.objectId); generateHallTable(session.objectId, cinema.name)" data-bs-toggle="modal" data-bs-target="#sessionModal">{{findById(session.attributes, 5)}}     {{findById(session.attributes, 9)}}</button>
                    </div>
                  </div>

                </div>
              </div>
              <hr>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Session Info Modal -->
  <section>
    <div class="modal fade" id="sessionModal" tabindex="-1" aria-labelledby="sessionModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="sessionModalLabel">{{getCurFilmName()}}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" (click)="clear()" aria-label="Close"></button>
          </div>
          <div *ngFor="let hall of halls">
            <p>{{hall.objectId}}</p>
          </div>
          <div class="modal-body">
            <table class="table">
              <tbody>
              <tr *ngFor="let col of cols">
                <th scope="row">{{col.name}}</th>
                <td *ngFor="let row of rows">
                  <button [disabled]="isBought(col.name, row.name)" type="button" class="btn btn-success">{{row.name}}</button>
<!--                  <ng-container *ngIf="isBought(col.name, row.name); then locked; else enabled"></ng-container>-->
<!--                  <ng-template #enabled>-->
<!--                    <button type="button" class="btn btn-success">{{row.name}}</button>-->
<!--                  </ng-template>-->
<!--                  <ng-template #locked>-->
<!--                    <button [disabled]="true" type="button" class="btn btn-danger">{{row.name}}</button>-->
<!--                  </ng-template>-->

                </td>
              </tr>

              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>

</body>
</html>


